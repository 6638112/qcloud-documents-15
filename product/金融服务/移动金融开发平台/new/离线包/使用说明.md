# 离线包使用说明

## 打包

1. 创建以H5应用标识命名的目录，将H5应用的离线资源放置在该目录下。

   假设H5应用标识为hybrid，所有离线资源都在webapp_scan目录下，离线包整体目录结构如下图：

   <img src="../../img/offline_package.png" style="border:1.5px solid">

2. 在终端中，使用`zip`命令将离线包文件压缩成.zip文件。

   ```shell
   $ zip -r hybrid.zip hybrid
   ```

   <img src="../../img/hybrid_package_zip.png" width=33% style="border:1.5px solid" >

   生成的hybrid.zip即是打包好的离线包，可以用来上传到控制台。

   

   注：Mac系统不推荐使用右键压缩的方式制作.zip文件，因为这样会包含__MACOSX文件夹，增大离线包的体积。

## 管理

### 业务管理

1. 进入**离线包** > **离线包管理**页面，在页面左上角点击**新增H5应用**，可创建业务，后续用于承载离线包，只有创建了应用之后，才可以上传并发布离线包。

   ![](../../img/1.png)

2. 创建H5应用时，需要填写“H5应用名称”、“H5应用标识”，勾选应用类型

   **字段说明**：

   - H5应用名称【必填】：通常为汉字，建议与客户端某个模块或者H5页面保持一致。
   - H5应用标识【必填】：可为字符串，作为业务的唯一标识。     
   - 虚拟域名【非必填】：为离线包指定一个虚拟域名。如果您的H5应用部署了在线资源，那么该域名需与在线资源域名一致。
   - 入口路径【非必填】：H5应用的入口地址，默认值为index.html。
   ![](../../img/2.png)

3. 创建完成后，可以选择建好的应用来进行离线包的上传、发布。

### 包管理

在离线包管理页面，选择一个应用，进入该应用的离线包管理页面。
上传离线包有2种方式，单独上传/批量上传。

**单独上传方式**

1. 在离线包管理页面，点击**添加离线包**。

   ![](../../img/4.png)
   

**批量上传方式**

1. 点击上方**批量上传离线包**

   ![](../../img/6.png)

2. 在弹起的窗口出，点击**批量上传**，选择要上传的压缩包文件，压缩包中包含多个应用离线包的压缩包，每一个包对应一个应用。

   ![](../../img/7.png)

   > ![](../../img/caution.png)注意：

   > - 命名规范须符合“bid.zip”， bid 即应用标识，需要提前创建好H5应用。


## 发布

### 离线包证书

离线包证书已包含在应用接入的配置文件中，开发者无需单独设置。



### 发布离线包

1. 登录TMF控制台，进入**离线包** > **离线包发布**模块，点击左上方**发布离线包**，唤起发布弹窗。

   ![](../../img/10.png)

2. 选择要发布的平台、对应的要发布的离线包版本，提交发布。

   ![](../../img/11.png)
