## 操作场景
本功能适用于站点下函数触发规则的如下操作：  

* 支持站点下函数触发规则的增删改查。  

* 支持快速调整触发规则的优先级，适用于请求URL匹配到多个触发规则的情况下快速调整执行位置的顺序，位置在前的触发规则将会执行，位置在后的触发规则将不会执行。  

## 操作介绍
登录 [边缘安全加速平台](https://console.cloud.tencent.com/edgeone)；
点击左侧导航栏 [触发配置](https://console.cloud.tencent.com/edgeone/edgefunctions/rules)  

![image](https://user-images.githubusercontent.com/114125357/197450566-d015b92e-200e-40ff-add0-42bbdb43c74f.png)   



### 新建触发规则
<img width="1781" alt="image" src="https://user-images.githubusercontent.com/114125357/197732792-e00cc50e-6022-4f85-bbc3-cf59d4c34e3b.png">

在规则列表页，点击![image](https://user-images.githubusercontent.com/114125357/197450590-fa017062-6502-4441-ad33-685e7cd83613.png)后如下图所示：  

![image](https://user-images.githubusercontent.com/114125357/197450607-79efd4be-f61d-410d-8d41-43de2d0a12a1.png)  
**参数说明**  

* 站点：默认显示当前站点名称。  

* 描述：非必填项，最多可支持60个字符。  

* 触发条件：按需选择匹配类型、运算符和值。  

* 执行函数：下拉选择已创建的函数。  

点击**确定**即可完成触发规则的新建。    



### 编辑触发规则
![image](https://user-images.githubusercontent.com/114125357/197451157-ff1f9cd4-d148-489b-9b9e-44dc9f30a1e4.png)  


点击上图中的**编辑**   

![image](https://user-images.githubusercontent.com/114125357/197451191-fd27f7ae-71ed-4089-b665-6f8021e0d1cb.png)

按需修改内容后通过点击**确定**即可完成触发规则的编辑。  


### 查询触发规则
![image](https://user-images.githubusercontent.com/114125357/197451297-94e401a4-18f4-44c1-b8ca-58b677aaedc1.png)  

点击![image](https://user-images.githubusercontent.com/114125357/197451335-d6e04756-6a31-4ea9-914d-08ac164ae7a1.png)
后在搜索的输入框中填写规则ID的关键词即可完成查询。  


### 删除触发规则
![image](https://user-images.githubusercontent.com/114125357/197451409-d0e750c8-d79c-42eb-a8a2-7eeb04bb9ac6.png)  

点击上图中的![image](https://user-images.githubusercontent.com/114125357/197451443-146c5a68-de00-424a-8f50-9ce37718928c.png)
和![image](https://user-images.githubusercontent.com/114125357/197451495-60cf964b-fc71-4530-9e00-7b8bc27e28e1.png)
后出现如下弹窗  
![image](https://user-images.githubusercontent.com/114125357/197451513-dbfeb47b-50e6-42c2-8a4b-2a10b15a2054.png)

点击**确认删除**即可完成触发规则的删除。

### 触发规则优先级调整
![image](https://user-images.githubusercontent.com/114125357/197451666-677b3179-33ef-42f5-aec2-572840277658.png)  



点击上图中的![image](https://user-images.githubusercontent.com/114125357/197451708-936dced7-ec6a-4492-ae8b-7f6acb85eab3.png)
和![image](https://user-images.githubusercontent.com/114125357/197451716-d8a6ab84-bbbd-457f-87be-b8431c1edbb8.png)   

  
  

![image](https://user-images.githubusercontent.com/114125357/197451752-5b9c0e96-d78c-4b5b-8c3b-f32b8f0fad70.png)
点击后，位置将会上移

![image](https://user-images.githubusercontent.com/114125357/197451761-b11fa6fc-8532-470f-918f-d48cd5aa0606.png)
点击后，位置将会下移动

若请求URL匹配到多个触发规则的情况下（如上图中序号为01和02的触发规则）位置在前的触发规则将会执行（如上图中的序号01规则），位置在后的触发规则将不会执行（如上图中的序号02规则）。

## 案例介绍
接下来的案例将为您介绍若请求URL匹配到多个触发规则的情况下，如何调整触发规则的执行顺序。

已新建相同的触发条件的两个不同函数，如下所示：     

![image](https://user-images.githubusercontent.com/114125357/197451846-532dd650-1d86-40f5-ad77-73facf427e99.png)  


![image](https://user-images.githubusercontent.com/114125357/197451876-f6aac4fc-182d-4ffa-b86f-dfb825e28d27.png)   
![image](https://user-images.githubusercontent.com/114125357/197451900-5b8ba1c5-332c-4f52-ac98-81619d398ebb.png)

函数test1的代码如下：
```
const testhtml = `<!DOCTYPE html>
<body>
  <h1>Hello World</h1>
  <p>This markup was generated by a TencentCloud  <br>EdgeOne Functions test 1.</br></p>
</body>`;

async function handleRequest(request) {
  return new Response(testhtml, {
    headers: {
      'content-type': 'text/html;charset=UTF-8',
       'test': 'Welcome to use Edge Functions.',
    },
  });
}

addEventListener('fetch', event => {
  return event.respondWith(handleRequest(event.request));
});  
```
函数test2的代码如下：
```
const testhtml = `<!DOCTYPE html>
<body>
  <h1>Hello World</h1>
  <p>This markup was generated by a TencentCloud  <br>EdgeOne Functions test 2.</br></p>
</body>`;

async function handleRequest(request) {
  return new Response(testhtml, {
    headers: {
      'content-type': 'text/html;charset=UTF-8',
       'test': 'Welcome to use Edge Functions.',
    },
  });
}

addEventListener('fetch', event => {
  return event.respondWith(handleRequest(event.request));
});   
```
函数test1的触发规则的顺序为01，函数test2的触发规则的顺序为02，如下图所示：
![image](https://user-images.githubusercontent.com/114125357/197452494-12fbacbf-c52a-414e-a189-cf72cf10f406.png)   




在浏览器中输入：http://edgefunctions.qcdntest.com.cn/  并回车，响应内容如下
![image](https://user-images.githubusercontent.com/114125357/197452642-47b4f926-bc4d-438c-8c22-74b5a47c8e83.png)   





函数test2点击后![image](https://user-images.githubusercontent.com/114125357/197452671-36600948-f280-4b61-b47b-f168570bfcf0.png)
，点击**保存**即可完成函数test2的触发规则的顺序为01，函数test1的触发规则的顺序为02的顺序调整。  

![image](https://user-images.githubusercontent.com/114125357/197452699-ae0f6e5f-42dd-4e37-b32e-23205cd1c555.png)   


![image](https://user-images.githubusercontent.com/114125357/197452720-cad1686a-442e-4c0e-8886-96ab02addb27.png)

再次在浏览器中输入：http://edgefunctions.qcdntest.com.cn/  并回车，响应内容如下：
![image](https://user-images.githubusercontent.com/114125357/197452748-30776108-04cc-4d07-8689-77405cc7e9d8.png)    

以上为若请求URL匹配到多个触发规则的情况下，如何调整触发规则的执行顺序的操作过程。

