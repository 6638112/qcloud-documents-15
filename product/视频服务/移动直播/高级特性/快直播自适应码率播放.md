## 示例代码
针对开发者的接入反馈的高频问题，腾讯云提供有更加简洁的 API-Example 工程，方便开发者可以快速的了解相关 API 的使用，欢迎使用。

| 所属平台 |                         GitHub 地址                          |
| :------: | :----------------------------------------------------------: |
|   iOS    | [Github](https://github.com/LiteAVSDK/Live_iOS/tree/main/MLVB-API-Example-OC) |
| Android  | [Github](https://github.com/LiteAVSDK/Live_Android/tree/main/MLVB-API-Example) |

## 功能介绍
在了解自适应码率播放之前，首先要了解什么是无缝切流。

- **无缝切流**：在切换不同码率的转码流时，能够做到无缝衔接，不会出现声音画面中断或者跳变的情况，实现观感和听感的平滑过渡。
- **自适应码率播放**：在无缝切流的基础上更进一步，无需用户干预，完全由当前网络带宽来决定实现自动无缝切流，确保播放的流畅度不受网络波动的影响。


## 开启自适应播放
自适应播放功能依托于腾讯云的**直播转码**支撑，如果您想要对接这个功能，需要在腾讯云的管理控制台 [开通直播转码服务](https://console.cloud.tencent.com/live/config/transcode)。服务开通之后，需要创建**两个即以上的转码模板**。
>? 
>- 自适应播放会在创建的转码模板中，通过当前网络带宽来选择一个转码模板进行播放
>- 在使用自适应播放功能时，切换至不同码流时会产生相应的直播 [转码费用](https://cloud.tencent.com/document/product/267/39889)。


### 创建转码模板
登录 [云直播控制台](https://console.cloud.tencent.com/live/config/transcode)，选择**功能配置** > **直播转码**，创建转码模板。如下图所示：
<img src="https://qcloudimg.tencent-cloud.cn/raw/770a5239926b3126e040a2dc69602847.png" width="900">

### 绑定域名

创建转码模板之后，需要绑定域名
<img src="https://qcloudimg.tencent-cloud.cn/raw/30e1efa271220e839dda5da8cdc46c64.png" width="600">


### 生成无缝切流与自适应播放 URL

- **原始播放URL：**[如何获取原始播放 URL](https://cloud.tencent.com/document/product/267/13551#.E6.AD.A5.E9.AA.A44.EF.BC.9A.E8.8E.B7.E5.8F.96.E6.92.AD.E6.94.BE.E5.9C.B0.E5.9D.80)
- **无缝切流**： 需要在原始播放 URL 的基础上增加两个参数 **tabr_bitrates** 和 **tabr_start_bitrate**。
- **自适应码率播放**：在无缝切流 URL 基础上，再新增一个参数 **tabr_control=auto**。

| 参数名称 |                         说明                          |
| ------ | ------ |
|  tabr_bitrates  | 转码模板列表，多个转码模板之间使用逗号隔开。转码模板必须已经在控制台中创建，并且按照码率从高到低进行排列。 |
| tabr_start_bitrate  | 当前要播放的转码模板，取值必须是转码模板列表中的一个 |
| tabr_control  | 打开自适应码率播放。取值固定为 “auto” |

**URL 地址样例：**

|     类型       |                         URL地址                          |
| ------ | ------ |
|  原始    | webrtc://xxx.liveplay.myqcloud.com/stream_name |
| 无缝切流  | webrtc://xxx.liveplay.myqcloud.com/stream_name?tabr_bitrates=720p,480p&tabr_start_bitrate=720p |
| 自适应播放  | webrtc://xxx.liveplay.myqcloud.com/stream_name?tabr_bitrates=720p,480p&tabr_start_bitrate=720p&tabr_control=auto |


### 无缝切流举例

假设创建了两个转码模板，名称分别为720p，480p。
- 以 720p 起：
```
V2TXLivePlayer.startPlay("webrtc://xxx.liveplay.myqcloud.com/stream_name?tabr_bitrates=720p,480p&tabr_start_bitrate=720p");
```
- 无缝切流到 480p：
```
V2TXLivePlayer.switchStream("webrtc://xxx.liveplay.myqcloud.com/stream_name?tabr_bitrates=720p,480p&tabr_start_bitrate=480p");
```

### 自适应码率播放举例
同样假设创建了两个转码模板，按照码率高低分别为 720p，480p。
以 720p 起播：
```
V2TXLivePlayer.startPlay("webrtc://xxx.liveplay.myqcloud.com/stream_name?tabr_bitrates=720p,480p&tabr_start_bitrate=720p&tabr_control=auto");
```

>! 
>- 在设置的 **tabr_bitrates** 参数中，转码模板必须已在控制台中创建，并且按照**码率由高到低进行排列**。
>- 进入自适应码率播放后，将无法进行无缝切流。除非去掉 `tabr_control=auto` 重新 startPlay。
